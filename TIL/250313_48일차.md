## ì˜¤ëŠ˜ í•œ ê²ƒ

### ì±„ë¬´ ë¶ˆì´í–‰ ì˜ˆì¸¡ í•´ì»¤í†¤: ë¶ˆì´í–‰ì˜ ì§•í›„ë¥¼ ì°¾ì•„ë¼!

[í”„ë¡œì íŠ¸ ë ˆí¬](https://github.com/FISA-3rd-PJT/prediction-of-default/blob/441bb0611dd5e205f9e285cd0a42dbd030404c95/README.md)


***

# ğŸ’° ì±„ë¬´ ë¶ˆì´í–‰ ì˜ˆì¸¡ í•´ì»¤í†¤: ë¶ˆì´í–‰ì˜ ì§•í›„ë¥¼ ì°¾ì•„ë¼!

<a href="https://dacon.io/competitions/official/236450/overview/description"><img src="https://github.com/user-attachments/assets/3a10c773-2c76-42f8-acac-eb2a937ea6cf"></img></a>
_ğŸ‘† click_

</br>

# ğŸ† 1. í”„ë¡œì íŠ¸ ê°œìš”
ì´ í”„ë¡œì íŠ¸ëŠ” **ê°œì¸ì˜ ì±„ë¬´ ë¶ˆì´í–‰ ì—¬ë¶€ë¥¼ ì˜ˆì¸¡í•˜ëŠ” AI ëª¨ë¸ì„ ê°œë°œ**í•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. 

ê¸ˆìœµ ì„œë¹„ìŠ¤ ì œê³µìì—ê²Œ ë¦¬ìŠ¤í¬ ê´€ë¦¬ì™€ ê³ ê° ë§ì¶¤í˜• ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´, ìˆ˜ì§‘ëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¨¸ì‹ ëŸ¬ë‹ ë° ë”¥ëŸ¬ë‹ ê¸°ë²•ì„ ì ìš©í•˜ì—¬ ì±„ë¬´ ë¶ˆì´í–‰ ì—¬ë¶€ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ êµ¬ì¶•í•˜ì˜€ìŠµë‹ˆë‹¤.



### ğŸš€ ìš°ë¦¬ FISA 4ê¸° AIì—”ì§€ë‹ˆì–´ë§

| [ê°•íš¨ì§„](https://github.com/KangHyojin1401) | [ìœ¤ì›…ìƒ](https://github.com/UngSangYoon)|  [ì´ì¬ì˜](https://github.com/lejy) | [í—ˆì •ì›](https://github.com/weonyee) |
|:---:|:---:|:---:|:---:|
|<img src="https://avatars.githubusercontent.com/u/67770370?v=4" width=100px alt="_"/>|<img width=100px src="https://avatars.githubusercontent.com/u/124053569?v=4" alt="_"/>|<img src="https://avatars.githubusercontent.com/u/129030474?v=4" width=100px alt="_"/>|<img src="https://avatars.githubusercontent.com/u/193207778?v=4" width=100px alt="_"/>|

### ğŸ“† í”„ë¡œì íŠ¸ ê¸°ê°„

**2025.03.12 - 2025.03.13**

</br></br>


# ğŸ“Š 2. ë°ì´í„°
## ğŸ“‚ 2-1. ë°ì´í„° ì„¤ëª…

- train: 10,000ê°œ
- test: 2,062ê°œ

</br>
  
### ğŸš¦ ì»¬ëŸ¼ êµ¬ì¡°
| #   | Column                   | Non-Null Count   | Dtype    |
|-----|--------------------------|------------------|----------|
| 0   | UID                      | 10000 non-null   | object   |
| 1   | ì£¼ê±° í˜•íƒœ                 | 10000 non-null   | object   |
| 2   | ì—°ê°„ ì†Œë“                 | 10000 non-null   | float64  |
| 3   | í˜„ì¬ ì§ì¥ ê·¼ì† ì—°ìˆ˜       | 10000 non-null   | object   |
| 4   | ì²´ë‚© ì„¸ê¸ˆ ì••ë¥˜ íšŸìˆ˜       | 10000 non-null   | float64  |
| 5   | ê°œì„¤ëœ ì‹ ìš©ê³„ì¢Œ ìˆ˜        | 10000 non-null   | int64    |
| 6   | ì‹ ìš© ê±°ë˜ ì—°ìˆ˜            | 10000 non-null   | float64  |
| 7   | ìµœëŒ€ ì‹ ìš©í•œë„             | 10000 non-null   | float64  |
| 8   | ì‹ ìš© ë¬¸ì œ ë°œìƒ íšŸìˆ˜       | 10000 non-null   | int64    |
| 9   | ë§ˆì§€ë§‰ ì—°ì²´ ì´í›„ ê²½ê³¼ ê°œì›” ìˆ˜ | 10000 non-null   | int64    |
| 10  | ê°œì¸ íŒŒì‚° íšŸìˆ˜            | 10000 non-null   | int64    |
| 11  | ëŒ€ì¶œ ëª©ì                  | 10000 non-null   | object   |
| 12  | ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„            | 10000 non-null   | object   |
| 13  | í˜„ì¬ ëŒ€ì¶œ ì”ì•¡            | 10000 non-null   | float64  |
| 14  | í˜„ì¬ ë¯¸ìƒí™˜ ì‹ ìš©ì•¡        | 10000 non-null   | float64  |
| 15  | ì›” ìƒí™˜ ë¶€ì±„ì•¡            | 10000 non-null   | float64  |
| 16  | ì‹ ìš© ì ìˆ˜                 | 10000 non-null   | int64    |
| 17  | ì±„ë¬´ ë¶ˆì´í–‰ ì—¬ë¶€          | 10000 non-null   | int64    |


![Image](https://github.com/user-attachments/assets/71df42d9-c82c-48d0-9a5d-a8932d864aae)

![Image](https://github.com/user-attachments/assets/44ef14b0-1c00-43a5-acf7-314838fc2811)



</br>

### ğŸ¤ ìƒê´€ê´€ê³„
![Image](https://github.com/user-attachments/assets/7c113836-ecdb-4ec5-92bd-e4b36d0782cf)

</br>

## ğŸ” 2-2. ë²”ì£¼í˜• ë°ì´í„° ì²˜ë¦¬


### ğŸ¯ ì£¼ê±° í˜•íƒœ(ë¹ˆë„) ë° ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„(ë¹ˆë„)

| ![ì£¼ê±° í˜•íƒœ - ë¹ˆë„](https://github.com/user-attachments/assets/fc3282a8-1d9b-4b27-9cec-c555052f94ee) | ![ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„ - ë¹ˆë„](https://github.com/user-attachments/assets/fb64279f-ad5a-4dd6-bdf0-04dfddbb3123) |
|:---------------------------------------------------:|:--------------------------------------------------------:|
| **ì£¼ê±° í˜•íƒœ(ë¹ˆë„)**                              | **ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„(ë¹ˆë„)**                                 |



### ğŸ¯ ì§ì¥ ê·¼ì† ì—°ìˆ˜(ë¹ˆë„) ë° ëŒ€ì¶œ ëª©ì (ë¹ˆë„)

| ![ì§ì¥ ê·¼ì† ì—°ìˆ˜ - ë¹ˆë„](https://github.com/user-attachments/assets/73469916-40f9-4eb2-861d-48daa4ea1632) | ![ëŒ€ì¶œ ëª©ì  - ë¹ˆë„](https://github.com/user-attachments/assets/e3e71298-ad41-4838-bca6-edca83cc75a7) |
|:----------------------------------------------------:|:---------------------------------------------------------:|
| **ì§ì¥ ê·¼ì† ì—°ìˆ˜(ë¹ˆë„)**                           | **ëŒ€ì¶œ ëª©ì (ë¹ˆë„)**                                      |



### ğŸ¯ ì£¼ê±° í˜•íƒœ(ë¹„ìœ¨) ë° ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„(ë¹„ìœ¨)

| ![ì£¼ê±° í˜•íƒœ - ë¹„ìœ¨](https://github.com/user-attachments/assets/a47d744c-5f22-48b7-8ef2-ac14463cdad3) | ![ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„ - ë¹„ìœ¨](https://github.com/user-attachments/assets/045ff075-82db-4ea2-a9f5-e1b6023cf33f) |
|:--------------------------------------------------:|:----------------------------------------------------------:|
| **ì£¼ê±° í˜•íƒœ(ë¹„ìœ¨)**                              | **ëŒ€ì¶œ ìƒí™˜ ê¸°ê°„(ë¹„ìœ¨)**                                  |



### ğŸ¯ ì§ì¥ ê·¼ì† ì—°ìˆ˜(ë¹„ìœ¨) ë° ëŒ€ì¶œ ëª©ì (ë¹„ìœ¨)

| ![ì§ì¥ ê·¼ì† ì—°ìˆ˜ - ë¹„ìœ¨](https://github.com/user-attachments/assets/b0202047-3c85-4fe5-b6e2-8c39b4bc7359) | ![ëŒ€ì¶œ ëª©ì  - ë¹„ìœ¨](https://github.com/user-attachments/assets/5b6a5113-aceb-4cc8-9fa1-d1796e2e3d72) |
|:--------------------------------------------------:|:----------------------------------------------------------:|
| **ì§ì¥ ê·¼ì† ì—°ìˆ˜(ë¹„ìœ¨)**                          | **ëŒ€ì¶œ ëª©ì (ë¹„ìœ¨)**                                       |


â¡ï¸ í•´ë‹¹ ë¹„ìœ¨ì„ **ë¼ë²¨ ì¸ì½”ë”© ìˆœì„œ**ë¡œ í™œìš©

</br>

## âš™ 2-3. ì „ì²˜ë¦¬

- **íŒŒìƒë³€ìˆ˜**
  ```python
  # íŒŒìƒ ë³€ìˆ˜ ìƒì„±: "ë§ˆì§€ë§‰ ì—°ì²´ ì´í›„ ê²½ê³¼ ê°œì›” ìˆ˜"ê°€ 0ì´ë©´ "ì—°ì²´ ì—†ìŒ" ì»¬ëŸ¼ ì¶”ê°€
  X["ì—°ì²´ ì—†ìŒ"] = (X["ë§ˆì§€ë§‰ ì—°ì²´ ì´í›„ ê²½ê³¼ ê°œì›” ìˆ˜"] == 0).astype(int)
  test_df["ì—°ì²´ ì—†ìŒ"] = (test_df["ë§ˆì§€ë§‰ ì—°ì²´ ì´í›„ ê²½ê³¼ ê°œì›” ìˆ˜"] == 0).astype(int)
  ```

- **ì´ìƒì¹˜ ì²˜ë¦¬**
  ```python
  def handle_outliers(df, col):
      Q1 = df[col].quantile(0.25)
      Q3 = df[col].quantile(0.75)
      IQR = Q3 - Q1
      lower_bound = Q1 - 1.5 * IQR
      upper_bound = Q3 + 1.5 * IQR
      df[col] = np.clip(df[col], lower_bound, upper_bound)
      return df
  
  numerical_cols = ['ì—°ê°„ ì†Œë“', 'ì²´ë‚© ì„¸ê¸ˆ ì••ë¥˜ íšŸìˆ˜', 'ê°œì„¤ëœ ì‹ ìš©ê³„ì¢Œ ìˆ˜', 'ì‹ ìš© ê±°ë˜ ì—°ìˆ˜', 'ìµœëŒ€ ì‹ ìš©í•œë„',
                    'ì‹ ìš© ë¬¸ì œ ë°œìƒ íšŸìˆ˜', 'ë§ˆì§€ë§‰ ì—°ì²´ ì´í›„ ê²½ê³¼ ê°œì›” ìˆ˜', 'ê°œì¸ íŒŒì‚° íšŸìˆ˜', 'í˜„ì¬ ëŒ€ì¶œ ì”ì•¡',
                    'í˜„ì¬ ë¯¸ìƒí™˜ ì‹ ìš©ì•¡', 'ì›” ìƒí™˜ ë¶€ì±„ì•¡', 'ì‹ ìš© ì ìˆ˜']
  
  for col in numerical_cols:
      df_train = handle_outliers(df_train, col)
      df_test = handle_outliers(df_test, col)
  ```


- **ìˆ˜ì¹˜ë³€ìˆ˜ ë¡œê·¸ë³€í™˜**
  ```python
  log_columns = ["í˜„ì¬ ë¯¸ìƒí™˜ ì‹ ìš©ì•¡", "ì›” ìƒí™˜ ë¶€ì±„ì•¡", "í˜„ì¬ ëŒ€ì¶œ ì”ì•¡"]
  for col in log_columns:
      X[col] = np.log1p(X[col])
      test_df[col] = np.log1p(test_df[col])
  ```

- **ê²°ì¸¡ê°’ ì²˜ë¦¬**
  ```python
  knn_imputer = KNNImputer(n_neighbors=25)
  X_imputed = knn_imputer.fit_transform(X)
  test_imputed = knn_imputer.transform(test_df)
  ```

</br></br>


# ğŸ¤– 3. ë”¥ëŸ¬ë‹ ëª¨ë¸(DL)

## ğŸ›  3-1. ìµœì  ì˜µí‹°ë§ˆì´ì € ì„ ì •

| ì˜µí‹°ë§ˆì´ì € | 50íšŒ | ì¡°ê¸°ì¢…ë£Œ |
|------------|---------|---------|
| ADAM       | 0.7344  | 0.7316  |
| RMSprop    | 0.7334  | 0.7316  |
| SGD        | 0.7332  | 0.7315  |
| adamW      | 0.7325  | 0.7312  |
| adagrad    | 0.7318  | 0.7319  |

</br>

## ğŸ” 3-2. í•˜ì´í¼ íŒŒë¼ë¯¸í„° íŠœë‹
í™œì„±í™”í•¨ìˆ˜, í•™ìŠµë¥ , input_dim, ë“œë¡­ì•„ì›ƒ, ë°°ì¹˜ ì‚¬ì´ì¦ˆ ë“±ì„ ìˆ˜ì •í•˜ë©° ì„±ëŠ¥ì´ ê°€ì¥ ë†’ê²Œ ë‚˜ì˜¤ëŠ” ê²½ìš°ë¥¼ ë„ì¶œ



```python
from itertools import product

optimizer_lr_pairs = []
for opt in ['Adam', 'SGD']:  # ìµœì í™”ëœ ì˜µí‹°ë§ˆì´ì €
    for lr in [0.01, 0.001]:  # ìµœì í™”ëœ í•™ìŠµë¥ 
        optimizer_lr_pairs.append((opt, lr))

first_size_options = [256, 128, 64]  # ìµœì í™”ëœ ì²« ë²ˆì§¸ ì¸µ í¬ê¸°
dropout_rate_options = [0.5, 0.3, 0.1]  # ìµœì í™”ëœ ë“œë¡­ì•„ì›ƒ ë¹„ìœ¨
batch_size_options = [64]  # ìµœì í™”ëœ ë°°ì¹˜ í¬ê¸°
activation_functions = [nn.ReLU, nn.LeakyReLU, nn.ELU]

all_combinations = product(optimizer_lr_pairs, first_size_options, dropout_rate_options, batch_size_options, activation_functions)

results = []
for combo in all_combinations:
    opt_lr, first_size, dropout_rate, batch_size, activation = combo
    opt_name, lr = opt_lr
    epoch, auc = train_and_evaluate(opt_name, lr, first_size, dropout_rate, batch_size, activation)
    results.append((opt_name, lr, first_size, dropout_rate, batch_size, activation.__name__, epoch, auc))

best_result = max(results, key=lambda x: x[-1])

print("Best hyper-parameters:", best_result[:-1])
print("Best ROC-AUC:", best_result[-1])

```


![Image](https://github.com/user-attachments/assets/819c438b-78d6-4581-8f75-4759293adaf4)

![Image](https://github.com/user-attachments/assets/cc29a8bb-0289-496e-9d28-3d6270a0bd37)



**âœ… 28 epoch**

**Best hyper-parameters: ('Adam', 0.001, 128, 0.3, 64, 'LeakyReLU', 28)**

**Best ROC-AUC: 0.7368424565791055**


```python
class CreditRiskModel(nn.Module):
    def __init__(self, input_dim, first_size, dropout_rate, activation):
        super(CreditRiskModel, self).__init__()
        self.activation = activation  # í™œì„±í™” í•¨ìˆ˜ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë°›ìŒ
        self.model = nn.Sequential(
            nn.Linear(input_dim, first_size),
            nn.BatchNorm1d(first_size),
            self.activation(),  # ì²« ë²ˆì§¸ ì€ë‹‰ì¸µì— ì ìš©

            nn.Dropout(dropout_rate),
            nn.Linear(first_size, first_size // 2),
            nn.BatchNorm1d(first_size // 2),
            self.activation(),  # ë‘ ë²ˆì§¸ ì€ë‹‰ì¸µì— ì ìš©

            nn.Dropout(dropout_rate),
            nn.Linear(first_size // 2, first_size // 4),
            nn.BatchNorm1d(first_size // 4),
            self.activation(),  # ì„¸ ë²ˆì§¸ ì€ë‹‰ì¸µì— ì ìš©

            nn.Dropout(dropout_rate),
            nn.Linear(first_size // 4, first_size // 8),
            self.activation(),  # ë„¤ ë²ˆì§¸ ì€ë‹‰ì¸µì— ì ìš©

            nn.Linear(first_size // 8, 1),
            nn.Sigmoid()  # ì¶œë ¥ì¸µ (ì´ì§„ ë¶„ë¥˜ë¥¼ ìœ„í•œ ì‹œê·¸ëª¨ì´ë“œ)
        )

    def forward(self, x):
        return self.model(x)
```
    
</br></br>

# ğŸ“¡ 4. ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸(ML)

## âš™ 4-1. ë°ì´í„° ì „ì²˜ë¦¬

- **ì´ìƒì¹˜ ì²˜ë¦¬**  
  - Winsorizing(ìƒ/í•˜ìœ„ 1% ê°’ í´ë¦¬í•‘)  
  - IQR(ì‚¬ë¶„ìœ„ ë²”ìœ„) ê¸°ë°˜ ì´ìƒì¹˜ ì¡°ì •
 
- **ë¡œê·¸ ë³€í™˜**  
  - í˜„ì¬ ë¯¸ìƒí™˜ ì‹ ìš©ì•¡, ì›” ìƒí™˜ ë¶€ì±„ì•¡, í˜„ì¬ ëŒ€ì¶œ ì”ì•¡ ë¡œê·¸ ë³€í™˜
    
- **íŒŒìƒ ë³€ìˆ˜ ì¶”ê°€**  
  - `ë§ˆì§€ë§‰ ì—°ì²´ ì´í›„ ê²½ê³¼ ê°œì›” ìˆ˜`ê°€ 0ì´ë©´ `ì—°ì²´ ì—†ìŒ` ì»¬ëŸ¼ ì¶”ê°€
    
- **ê²°ì¸¡ì¹˜ ì²˜ë¦¬**  
  - KNNImputer(n_neighbors=25)ë¥¼ ì´ìš©í•œ ê²°ì¸¡ì¹˜ ë³´ê°„
    
- **ì •ê·œí™”**  
  - StandardScalerë¥¼ ì‚¬ìš©í•˜ì—¬ í‰ê·  0, ë¶„ì‚° 1ë¡œ ë³€í™˜

</br>

## ğŸ’¡ 4-2. í•˜ì´í¼ íŒŒë¼ë¯¸í„° íŠœë‹

```python
param_grid_rf = {
    'n_estimators': [50, 100, 200],
    'max_depth': [None, 10, 20],
    'min_samples_split': [2, 5, 10]
}

param_grid_xgb = {
    'n_estimators': [50, 100, 200],
    'max_depth': [3, 5, 7],
    'learning_rate': [0.01, 0.1, 0.3]
}

param_grid_lgbm = {
    'n_estimators': [50, 100, 200],
    'max_depth': [3, 5, 7],
    'learning_rate': [0.01, 0.1, 0.3]
}
```

</br>

## ğŸ“ˆ 4-3. ëª¨ë¸ í•™ìŠµ ë° í‰ê°€


![Image](https://github.com/user-attachments/assets/74b1ecf9-11f3-4a13-bab0-5477682b5583)


### **ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression)**

- `C=1e-17, L2 ê·œì œ ì ìš©`
- `solver='liblinear'` ì‚¬ìš©
- ROC-AUC ì ìˆ˜ í‰ê°€

```python
best_model = LogisticRegression(
    random_state=42,
    solver='liblinear',
    penalty='l2',
    C=1e-17
)
best_model.fit(X_scaled, y)
```

### ğŸ“Š ëª¨ë¸ ë¹„êµ ê²°ê³¼


| ![ëª¨ë¸ 1](https://github.com/user-attachments/assets/fb0f7467-5d5a-44c4-8452-3a54d750c560) |  |
|:---------------------------------------------------:|:----------------------------------------------------:|
| **logistic regression coefficients** |  |

| ![ëª¨ë¸ 3](https://github.com/user-attachments/assets/f1c6306f-8978-42cb-85ca-c0f0bba3c30e) | ![ëª¨ë¸ 2](https://github.com/user-attachments/assets/5af08f58-de01-4e56-9587-0a65e5b147ef) |
|:---------------------------------------------------:|:----------------------------------------------------:|
| **ROC-AUC ì»¤ë¸Œ** | **Confusion matrix** |

</br></br>

# ğŸ† 5. í•´ì»¤í†¤ ë­í‚¹

![422196805-e5169478-a504-41e9-8c11-db7902e2d082](https://github.com/user-attachments/assets/e3273a2d-d4ea-4d21-8a0d-0efa16c11ca7)
